<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,
            initial-scale=1, shrink-to-fit=no">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="stylesheet.css">
    <title>Request a book</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-danger text-white navbar-dark py-1 fixed-top">
        <div class="container">
            <a href="home.html" class="navbar-brand">Classic Reads</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navmenu">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navmenu">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a href="home.html" class="nav-link">Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="about.html" class="nav-link">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a href="products.html" class="nav-link">Books</a>
                    </li>
                    <li class="nav-item">
                        <a href="request.html" class="nav-link">Request</a>
                    </li>
                    <li class="nav-item">
                        <a href="contact.html" class="nav-link">Contact Us</a>
                    </li>
                </ul>
                <form class="d-flex" role="search">
                    <input class="form-control form-control-sm me-2" type="search" placeholder="Search"
                        aria-label="Search">
                    <button class="btn btn-outline-light btn-sm" type="submit">Search</button>
                </form>
            </div>
        </div>
    </nav>

    <section id="heading">
        <div class="container">
            <div class="rounded p-5 bg-danger-subtle" style="width: 90%; margin: 0 auto;">
                <h1>Request a book</h1>
                <p class="lead pt-1">Complete the below form, and we will do our best to stock the book for you.</p>
            </div>
        </div>
    </section>

    <section class="text-center pb-2">
        <h3>Book Request Form</h3>
    </section>

    <form class="needs-validation" action="/submit-request" method="post"> <!--Added action and method for server submission-->
        <div class="container rounded p-4 bg-light">
            <h4 class="text-secondary">Book Details</h4>
            <div class="row mt-1 g-3">
                <div class="col-sm-6">
                    <label for="bookTitle" class="form-label">Title</label>
                    <input type="text" name="bookTitle" id="bookTitle" class="form-control">
                </div>
                <div class="col-sm-6 mb-3">
                    <label for="author" class="form-label">Author</label>
                    <input type="text" name="author" id="author" class="form-control">
                </div>
            </div>
            <div class="row g-3">
                <div class="mb-1">
                    <label for="commentField" class="form-label">Additional comments (optional)</label>
                    <textarea class="form-control" id="commentField" name="commentField" rows="3"></textarea>
                </div>
            </div>
            <h4 class="text-secondary pt-4">Your Contact Details</h4>
            <div class="row mt-1 g-3">
                <div class="col-sm-6">
                    <label for="firstname" class="form-label">First name</label>
                    <input type="text" name="firstname" id="firstname" class="form-control">
                </div>
                <div class="col-sm-6 mb-3">
                    <label for="surname" class="form-label">Surname</label>
                    <input type="text" name="surname" id="surname" class="form-control">
                </div>
            </div>
            <div class="row g-3">
                <div class="col-sm-6">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" id="email" name="email" class="form-control">
                </div>
                <div class="col-sm-3">
                    <label for="tel" class="form-label">Mobile</label>
                    <input type="tel" id="mobile" name="mobile" class="form-control" placeholder="04xxxxxxxx"
                        pattern="[0-9]{10}">
                </div>
                <div class="col-sm-3">
                    <div class="form-check form-switch mt-3 pt-4">
                        <input class="form-check-input" type="checkbox" role="switch" id="newsletter" name="newsletter">
                        <label class="form-check-label" for="newsletter">Opt in to our newsletter</label>
                    </div>
                </div>
            </div>

        </div>
        <br>
        <div class="row g-3 mt-3 justify-content-center">
            <div class="col-3 d-grid mx-auto">
                <button class="btn btn-primary" type="submit">Submit</button>
            </div>
        </div>
        <div class="row g-3 mt-1 mb-5 pb-5 justify-content-center">
            <div class="col-3 d-grid mx-auto">
                <button type="reset" class="btn btn-secondary">Reset</button>
            </div>
        </div>
    </form>

    <footer id="footer" class="bg-dark">
        <div class="container">
            <p>&copy; 2025 Classic Reads &nbsp; s225445344@deakin.edu.au &nbsp; Last updated: 30 April 2025</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <script>
        (() => {
            'use strict'

            // selecting all forms with class 'needs-validation'
            const forms = document.querySelectorAll('.needs-validation')

            // looping over form
            Array.from(forms).forEach(form => {
                // event listener for form's submit event
                form.addEventListener('submit', event => {
                    // initialising a flag to track overall form validity
                    let isValid = true;

                    // getting references to key input elements
                    const nameInput = form.querySelector('#firstname');
                    const surnameInput = form.querySelector('#surname');
                    const emailInput = form.querySelector('#email');
                    const mobileInput = form.querySelector('#mobile');
                    const titleInput = form.querySelector('#bookTitle');
                    const authorInput = form.querySelector('#author');

                    // clearing any previous error messages displayed
                    const errorElements = form.querySelectorAll('.error-message');  // assigns to variable, all elements currently present with class error-message
                    errorElements.forEach(el => el.remove());  // loops through anything found in previous line, and removes them from form

                    // validation checks below:

                    // checking if fields are blank
                    if (!titleInput.value.trim()) {  // if this gets value that is empty (nothing entered) condition is true, and code in curly brackets is executed
                        isValid = false;
                        displayError(titleInput, 'Please enter the book title.');
                    }

                    if (!authorInput.value.trim()) {
                        isValid = false;
                        displayError(authorInput, 'Please enter the author\'s name.');
                    }

                    if (!nameInput.value.trim()) {
                        isValid = false;
                        displayError(nameInput, 'Please enter your first name.');
                    }

                    if (!surnameInput.value.trim()) {
                        isValid = false;
                        displayError(surnameInput, 'Please enter your surname.');
                    }

                    if (!emailInput.value.trim()) {
                        isValid = false;
                        displayError(emailInput, 'Please enter your email address.');
                    }

                    if (!mobileInput.value.trim()) {
                        isValid = false;
                        displayError(mobileInput, 'Please enter your mobile number.');
                    }

                    // email format validation
                    if (emailInput.value.trim() && !isValidEmail(emailInput.value.trim())) {
                        isValid = false;
                        displayError(emailInput, 'Please enter a valid email address (e.g., user@example.com).');
                    }

                    // phone number validation (digits only and max length)
                    const mobileValue = mobileInput.value.trim();
                    if (mobileValue && !/^[0-9]+$/.test(mobileValue)) {
                        isValid = false;
                        displayError(mobileInput, 'Mobile number must contain only digits.');
                    }
                    if (mobileValue && mobileValue.length > 10) {
                        isValid = false;
                        displayError(mobileInput, 'Mobile number cannot exceed 10 digits.');
                    }

                    // preventing form submission if validation fails
                    if (!isValid) {
                        event.preventDefault()
                        event.stopPropagation()
                    } else {
                        alert('Request submitted!');
                    }

                    // adding bootstrap's 'was-validated' class to trigger visual feedback
                    form.classList.add('was-validated')
                }, false)

                // selecting all input and select elements
                const inputs = form.querySelectorAll('.form-control, .form-select');

                // adding an input event listener for input and select elements
                inputs.forEach(input => {
                    input.addEventListener('input', () => {
                        input.classList.remove('is-invalid');
                    });  // removing Bootstrap's invalid styling as the user types

                    // adding a blur event listener to each form control
                    input.addEventListener('blur', () => {
                        // if input is invalid according to Bootstrap's basic checks and has been touched, display its message
                        if (!input.checkValidity()) {
                            displayError(input, input.validationMessage);
                        }
                    });
                });

                // function checking if an email address has a basic valid format
                function isValidEmail(email) {
                    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
                }  // uses a regular expression

                // function to display an error message below an input element
                function displayError(inputElement, errorMessage) {
                    const errorDiv = document.createElement('div');
                    errorDiv.classList.add('error-message', 'text-danger', 'small');
                    errorDiv.textContent = errorMessage;
                    inputElement.parentNode.insertBefore(errorDiv, inputElement.nextSibling);
                    inputElement.classList.add('is-invalid'); // adding Bootstrap's invalid styling
                }
            })
        })()
    </script>
</body>